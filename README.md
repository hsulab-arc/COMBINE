# A combinatorial domain screening platform reveals epigenetic effector interactions for transcriptional perturbation

Additional data and codes to accompany the preprint 


# Generating unique 15-mer IDs for Library 1 NGS analysis


Follow with the example data - 

To address the issue of lower R2 sequencing quality, which is occasionally observed during paired-end readout of long fragments[^1], we implemented an approach of spreading ten 15-mer short identifiers (IDs) across the entire 301 bp sequencing region. If any of the 10 IDs exactly matched the NGS read, the read was assigned to the corresponding domain. Unique 15 mer IDs for identifying N- and C-terminal domains were generated by the following steps. 
[^1]: Tan, G., Opitz, L., Schlapbach, R., and Rehrauer, H. (2019). Long fragments achieve lower base quality in Illumina paired-end sequencing. Sci. Rep. 9, 2856.



* Step 1) From fasta files composed of expected 301 bp NGS reads for every domain (R1_Forward_P5_301cycles.fasta & R2_Reverse_P7_301cycles.fasta), all possible unique 15 mers were generated using UniqueKMER[^2] with the following commands. 
[^2]: Chen, S., He, C., Li, Y., Li, Z., and Melançon, C.E. (2021). A computational toolset for rapid identification of SARS-CoV-2, other viruses and microorganisms from sequencing data. Brief. Bioinform. 22, 924–935.

```bash
$ uniquekmer -f R1_Forward_P5_301cycles.fasta -k 15 -o "kmercollection_R1"
$ uniquekmer -f R2_Reverse_P7_301cycles.fasta -k 15 -o "kmercollection_R2"
```


* Step 2) If a 15 mer ID for one domain had a hamming distance of less than 2 with an ID from another domain, one of the IDs was deleted from the domain with a larger number of IDs by executing Library1_step2.py. Output files were numerically sorted using Seqkit[^3] with the following commands.
[^3]: Shen, W., Sipos, B., and Zhao, L. (2024). SeqKit2: A Swiss army knife for sequence and alignment processing. Imeta. 10.1002/imt2.191.


```bash
$ seqkit sort -nN R1_15mer_HD2_UMIs.fasta -o R1_15mer_HD2_UMIs_sorted.fasta
$ seqkit sort -nN R2_15mer_HD2_UMIs.fasta -o R2_15mer_HD2_UMIs_sorted.fasta
```



* Step 3) Using pairwise2 (Biopython) local alignment mode with the scoring scheme of (match: 1, mismatch: 0, opening gap: -1, extending gap: -1), IDs that had an alignment score higher than 12 with any other domains’ expected 301 bp NGS reads were removed. Also, 10 IDs were chosen to be spread across the 301 bp region as evenly as possible by executing Library1_step3.py. 



* Step 4) For domains that ended up with fewer than 10 IDs, previously removed IDs with alignment scores (pairwise2) of 13 were recalled and assigned to ensure that the total number of IDs reached 10 for every domain by executing Library1_step4.py.


10 IDs got generated for each domain.
* R1_15mer_UMIs_10per_effector.fasta
* R2_15mer_UMIs_10per_effector.fasta
